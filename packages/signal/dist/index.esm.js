var e={d:function(t,s){for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t={};e.d(t,{z6:function(){return M},j5:function(){return a},Cw:function(){return r},OH:function(){return c},gq:function(){return g},Ou:function(){return B},Mm:function(){return _},sR:function(){return z},BO:function(){return Q},HN:function(){return u},oR:function(){return s},AF:function(){return o},fB:function(){return p},t9:function(){return i},vq:function(){return P},vA:function(){return n},kg:function(){return h},EW:function(){return d},uu:function(){return F},n5:function(){return l},qr:function(){return w},Yz:function(){return D},H8:function(){return b},QZ:function(){return v},mj:function(){return y},IH:function(){return I},Vp:function(){return k},Hp:function(){return E},Tj:function(){return m},se:function(){return S},aH:function(){return H},Bs:function(){return x},bb:function(){return q},EN:function(){return C},v6:function(){return O},Pf:function(){return f},$k:function(){return T}});class s{static instance;computationStack=[];batchDepth=0;batchQueue=new Set;activeEffects=new Set;static getInstance(){return this.instance||(this.instance=new s),this.instance}getCurrentComputation(){return this.computationStack[this.computationStack.length-1]}pushComputation(e){e&&this.computationStack.includes(e)||this.computationStack.push(e)}popComputation(){this.computationStack.pop()}isBatching(){return this.batchDepth>0}beginBatch(){this.batchDepth++}endBatch(){this.batchDepth--,0===this.batchDepth&&this.flushBatchQueue()}addToBatchQueue(e){this.batchQueue.add(e)}flushBatchQueue(){const e=new Set(this.batchQueue);this.batchQueue.clear();const t=new Set;for(const s of e)for(const e of s.getDependents())t.add(e);for(const e of t)e.markDirty()}setCurrentComputation(e){this.computationStack[this.computationStack.length-1]=e}registerEffect(e){this.activeEffects.add(e)}unregisterEffect(e){this.activeEffects.delete(e)}isInEffect(){return this.activeEffects.size>0}}function n(e){const t=s.getInstance();t.beginBatch();try{return e()}finally{t.endBatch()}}class i{static instance;queue=new Set;processing=!1;updateDepth=0;maxUpdateDepth=1e3;static getInstance(){return this.instance||(this.instance=new i),this.instance}schedule(e){if(this.updateDepth>=this.maxUpdateDepth)throw new Error("Maximum update depth exceeded - possible circular dependency");this.queue.add(e),this.processing||this.processQueue()}processQueue(){this.processing=!0,this.updateDepth++;try{for(;this.queue.size>0;){const e=Array.from(this.queue);this.queue.clear(),e.sort(((e,t)=>e.getDepth()-t.getDepth()));for(const t of e)t.isDirty()&&!t.isDisposed()&&t.recompute()}}finally{this.processing=!1,this.updateDepth--}}}class r{dirty=!0;disposed=!1;dependencies=new Set;dependents=new Set;depth=0;name;constructor(e){this.name=e}addDependency(e){this.dependencies.has(e)||(this.dependencies.add(e),e instanceof c&&this.updateDepth())}removeDependency(e){this.dependencies.delete(e)&&this.updateDepth()}dispose(){this.disposed||(this.disposed=!0,this.clearDependencies(),this.dependents.clear())}isDirty(){return this.dirty}isDisposed(){return this.disposed}getDepth(){return this.depth}markDirty(){this.disposed||(this.dirty=!0,i.getInstance().schedule(this))}clearDependencies(){for(const e of this.dependencies)e.removeDependent(this);this.dependencies.clear(),this.updateDepth()}updateDepth(){const e=this.depth;let t=0;for(const e of this.dependencies)e instanceof c&&(t=Math.max(t,e.getDepth()+1));if(e!==t){this.depth=t;for(const e of this.dependents)e.updateDepth()}}hasSignal(e){return this.dependencies.has(e)}}class o extends Error{constructor(e){super(`Cannot ${e} a disposed signal`),this.name="SignalDisposedError"}}class a extends Error{constructor(e){super("Circular dependency detected"+(e?` in signal "${e}"`:"")),this.name="CircularDependencyError"}}class u{equals;_value;dependents=new Set;disposed=!1;name;constructor(e,t={}){this._value=e,this.equals=t.equals??Object.is,this.name=t.name||"anonymous"}get value(){if(this.disposed)throw new o("read from");return this.trackDependency(),this._value}set value(e){if(this.disposed)throw new o("write to");this.equals(this._value,e)||(this._value=e,this.notifyDependents())}get_value_bypass_tracking(){if(this.disposed)throw new o("read from");return this._value}update(e){this.value=e(this._value)}subscribe(e){if(this.disposed)throw new o("subscribe to");const t=new c((()=>e(this.value)));return()=>t.dispose()}trackDependency(){const e=s.getInstance().getCurrentComputation();e&&(e.addDependency(this),this.addDependent(e))}addDependent(e){this.dependents.add(e)}removeDependent(e){this.dependents.delete(e)}notifyDependents(){const e=s.getInstance();if(e.isBatching())e.addToBatchQueue(this);else for(const e of this.dependents)e.markDirty()}dispose(){if(this.disposed)return;this.disposed=!0;const e=new Set(this.dependents);this.dependents.clear();for(const t of e)if(t instanceof c||t.signal instanceof c){(t instanceof c?t:t.signal).dispose()}else t.dispose()}isDisposed(){return this.disposed}getDependents(){return this.dependents||new Set}hasDependents(){return this.dependents.size>0}toString(){return`Signal(${this.name})`}}class c extends u{computation;computeFn;constructor(e,t={}){super(void 0,t),this.computeFn=e,this.computation=new class extends r{signal;constructor(e){super(e.name),this.signal=e}recompute(){if(this.disposed)return;const e=s.getInstance(),t=e.getCurrentComputation();if(e.setCurrentComputation(this),e.isInEffect())throw new a("Cannot create computed signal that depends on effects");try{for(const e of this.dependencies)if(e.isDisposed())throw this.signal.dispose(),new o("read from disposed dependency");const e=this.signal.computeFn();this.signal.equals(this.signal._value,e)||(this.signal._value=e,this.signal.notifyDependents())}catch(e){throw e instanceof o&&this.signal.dispose(),e}finally{t&&e.setCurrentComputation(t),this.dirty=!1}}}(this),this.computation.recompute()}get value(){if(this.disposed)throw new o("read from");const e=this.computation.dependencies;for(const t of e)if(t.isDisposed())throw this.dispose(),new o("read from disposed dependency");return this.computation.isDirty()&&this.computation.recompute(),this.trackDependency(),this._value}set value(e){throw new Error("Cannot set the value of a computed signal")}getDepth(){return this.computation.getDepth()}dispose(){if(!this.disposed){super.dispose(),this.computation.dispose();for(const e of this.dependents)if(e instanceof c||e.signal instanceof c){(e instanceof c?e:e.signal).dispose()}}}}function d(e,t){return new c(e,t)}function h(e,t){return d((()=>e.map((e=>e.value))),{equals:t?.equals??((e,t)=>!(!e||!t||e.length!==t.length)&&e.every(((e,s)=>Object.is(e,t[s])))),name:t?.name||`Signal(combine)[${e.map((e=>e.toString())).join(", ")}]`})}class p{static metrics={updates:0,computations:0,maxChainDepth:0,averageUpdateTime:0};static updateTimes=[];static trackUpdate(e){this.metrics.updates++,this.updateTimes.push(e),this.updateTimes.length>100&&this.updateTimes.shift(),this.metrics.averageUpdateTime=this.updateTimes.reduce(((e,t)=>e+t),0)/this.updateTimes.length}static trackComputation(e){this.metrics.computations++,this.metrics.maxChainDepth=Math.max(this.metrics.maxChainDepth,e)}static getMetrics(){return{...this.metrics}}static reset(){this.metrics={updates:0,computations:0,maxChainDepth:0,averageUpdateTime:0},this.updateTimes=[]}}function l(e,t){return new u(e,t)}function f(e,t,s){const n=l(e,s),i=d((()=>{const e=t(n.value);return"string"==typeof e?e:e?null:"Validation failed"}));return new Proxy(n,{get(e,t){if("value"===t){const t=i.value;if(t)throw new Error(t);return e.value}return e[t]},set(e,s,n){if("value"===s){const s=t(n);if("string"==typeof s)throw new Error(s);if(!s)throw new Error("Validation failed");e.value=n}return!0}})}function m(e,t,s){return d((()=>t(e.value)),s)}class g{computation;cleanup;disposed=!1;constructor(e,t){this.computation=new class extends r{effect;fn;constructor(e,s){super(t),this.effect=e,this.fn=s}recompute(){if(this.disposed)return;const e=s.getInstance();e.pushComputation(this);try{e.pushComputation(this),e.registerEffect(this.effect),this.effect.runEffect()}finally{e.unregisterEffect(this.effect),e.popComputation(),this.dirty=!1}}}(this,e),this.computation.recompute()}runEffect(){if(!this.disposed){if(this.cleanup)try{this.cleanup()}catch(e){console.error("Error in effect cleanup:",e)}try{this.cleanup=this.computation.fn()}catch(e){throw console.error("Error in effect:",e),e}}}dispose(){if(!this.disposed){if(this.disposed=!0,this.cleanup)try{this.cleanup()}catch(e){console.error("Error in effect cleanup:",e)}this.computation.dispose()}}}function v(e,t){return new g(e,t)}function w(e,t,s){const n=l(e.value,s);let i;return v((()=>{const s=e.value;return i&&clearTimeout(i),i=setTimeout((()=>{n.value=s}),t),()=>{i&&clearTimeout(i)}})),n}function y(e,t,s){const n=l(e.value,s);return v((()=>{const s=e.value;t(s)&&(n.value=s)})),n}function D(e,t){return v((()=>{console.log(`[Signal Debug] ${t}:`,e.value)}),`debug-${t}`),e}function S(e){const t=s.getInstance(),n=t.getCurrentComputation();t.setCurrentComputation(void 0);try{return e.get_value_bypass_tracking()}finally{n&&t.setCurrentComputation(n)}}function C(e,t,s){return d((()=>{const s=e.value,n=S(e);return Math.abs(s-n)>=t?s:n}),{...s,equals:(e,s)=>Math.abs(e-s)<t})}const b=(e,t)=>Object.is(e,t),q=e=>JSON.stringify({value:e.value,name:e.name,disposed:e.disposed});function E(e){return e instanceof u}function I(e){return e instanceof c?e.getDepth():0}function k(e){const t=new Set,s=new Set;return function e(n){if(s.has(n))return!0;if(t.has(n))return!1;t.add(n),s.add(n);const i=n.dependents||new Set;for(const t of i)if(t.computation?.signal&&e(t.computation.signal))return!0;return s.delete(n),!1}(e)}function x(){s.instance=void 0,i.instance=void 0,p.reset()}function T(e,t=10,s){const i=s?.equals??b,r=l(e,{...s,equals:i}),o=l([e]),a=l(0),u=d((()=>a.value>0)),c=d((()=>a.value<o.value.length-1)),h=Object.create(r);return h.history=o,h.canUndo=u,h.canRedo=c,Object.defineProperty(h,"value",{get:()=>r.value,set:e=>{i(r.value,e)||n((()=>{const s=a.value+1,n=o.value.slice(0,s).concat([e]);n.length>t?(n.shift(),a.value=s-1):a.value=s,o.value=n,r.value=e}))}}),h.undo=()=>{u.value&&n((()=>{a.value--,r.value=o.value[a.value]}))},h.redo=()=>{c.value&&n((()=>{a.value++,r.value=o.value[a.value]}))},h}function O(e,t,s){const n=l(e.value,s);let i,r=0;return v((()=>{const s=e.value,o=Date.now();return o-r>=t?(n.value=s,r=o):i||(i=setTimeout((()=>{n.value=s,r=Date.now(),i=void 0}),t-(o-r))),()=>{i&&clearTimeout(i)}})),n}class B{getItem(e){if("undefined"==typeof window)return null;const t=window.localStorage.getItem(e);return t?JSON.parse(t):null}setItem(e,t){"undefined"!=typeof window&&window.localStorage.setItem(e,JSON.stringify(t))}removeItem(e){"undefined"!=typeof window&&window.localStorage.removeItem(e)}}class Q{getItem(e){if("undefined"==typeof window)return null;const t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}setItem(e,t){"undefined"!=typeof window&&window.sessionStorage.setItem(e,JSON.stringify(t))}removeItem(e){"undefined"!=typeof window&&window.sessionStorage.removeItem(e)}}class _{store=new Map;getItem(e){return this.store.get(e)??null}setItem(e,t){this.store.set(e,t)}removeItem(e){this.store.delete(e)}}class j extends u{storage;key;disposed=!1;constructor(e,t,s,n){super(s.getItem(e)??t,n),this.key=e,this.storage=s,v((()=>{this.disposed||this.storage.setItem(this.key,this.value)}),`persist-${e}`)}get value(){if(this.disposed)throw new o("Cannot read from disposed signal");return super.value}set value(e){if(this.disposed)throw new o("Cannot write to disposed signal");super.value=e}update(e){if(this.disposed)throw new o("Cannot update disposed signal");this.value=e(this.value)}dispose(){this.disposed||(this.disposed=!0,this.storage.removeItem(this.key),super.dispose())}reload(){if(this.disposed)throw new o("Cannot reload disposed signal");const e=this.storage.getItem(this.key);null!==e&&(this.value=e)}clear(){if(this.disposed)throw new o("Cannot clear disposed signal");this.storage.removeItem(this.key)}isDisposed(){return this.disposed}}function H(e,t,s,n){return new j(e,t,s,n)}class M extends u{fetchFn;options;abortController=null;constructor(e,t={}){super({data:null,loading:!1,error:null,timestamp:0},t),this.fetchFn=e,this.options=t}async fetch(e=!1){if(this.isCacheValid()&&!e)return this.value.data;this.abortController&&this.abortController.abort(),this.abortController=new AbortController,this.value={...this.value,loading:!0,error:null};let t=0;const s=this.options.retryConfig?.attempts||1,n=this.options.retryConfig?.delay||1e3,i=this.options.retryConfig?.backoffFactor||2;for(;t<s;)try{const e=await this.fetchFn();return this.value={data:e,loading:!1,error:null,timestamp:Date.now()},this.options.onSuccess?.(e),e}catch(e){if(t++,t===s)return this.value={...this.value,loading:!1,error:e},this.options.onError?.(e),null;await new Promise((e=>setTimeout(e,n*Math.pow(i,t-1))))}return null}isCacheValid(){if(!this.options.cache?.enabled)return!1;if(!this.value.data)return!1;const e=this.options.cache.ttl||3e5;return Date.now()-this.value.timestamp<e}refresh(){return this.fetch(!0)}dispose(){this.abortController&&this.abortController.abort(),super.dispose()}}function P(e,t){return new M(e,t)}class z{queue;constructor(){this.queue=l([])}enqueue(e,t=0){const s=Math.random().toString(36).substring(2),n={id:s,data:e,priority:t,timestamp:Date.now()};return this.queue.value=[...this.queue.value,n].sort(((e,t)=>t.priority-e.priority||e.timestamp-t.timestamp)),s}dequeue(){if(this.isEmpty())return;const[e,...t]=this.queue.value;return this.queue.value=t,e?.data}peek(){return this.queue.value[0]?.data}remove(e){const t=this.queue.value.length;return this.queue.value=this.queue.value.filter((t=>t.id!==e)),t!==this.queue.value.length}clear(){this.queue.value=[]}isEmpty(){return 0===this.queue.value.length}size(){return this.queue.value.length}getQueue(){return this.queue}}function F(){return new z}var N=t.z6,$=t.j5,U=t.Cw,A=t.OH,V=t.gq,J=t.Ou,R=t.Mm,W=t.sR,Y=t.BO,Z=t.HN,L=t.oR,G=t.AF,K=t.fB,X=t.t9,ee=t.vq,te=t.vA,se=t.kg,ne=t.EW,ie=t.uu,re=t.n5,oe=t.qr,ae=t.Yz,ue=t.H8,ce=t.QZ,de=t.mj,he=t.IH,pe=t.Vp,le=t.Hp,fe=t.Tj,me=t.se,ge=t.aH,ve=t.Bs,we=t.bb,ye=t.EN,De=t.v6,Se=t.Pf,Ce=t.$k;export{N as AsyncSignal,$ as CircularDependencyError,U as Computation,A as ComputedSignal,V as EffectImpl,J as LocalStorageProvider,R as MemoryStorageProvider,W as QueueSignal,Y as SessionStorageProvider,Z as Signal,L as SignalContext,G as SignalDisposedError,K as SignalMonitor,X as UpdateQueue,ee as asyncSignal,te as batch,se as combine,ne as computed,ie as createQueueSignal,re as createSignal,oe as debounced,ae as debug,ue as defaultEquals,ce as effect,de as filtered,he as getSignalDepth,pe as hasCircularDependency,le as isSignal,fe as map,me as peek,ge as persisted,ve as resetSignalSystem,we as serializeSignal,ye as threshold,De as throttled,Se as validated,Ce as withHistory};